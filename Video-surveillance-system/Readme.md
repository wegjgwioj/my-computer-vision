# 视频监控系统

## 概述

视频监控系统是一个基于 Flask 的 Web 应用程序，旨在为用户提供通过网页界面管理和实时查看多个视频流的功能。该系统支持用户对视频流进行基本操作（如打开、暂停、继续和关闭），并允许实时调整视频参数，包括亮度、对比度、饱和度、锐化、色温、降噪、模糊、晕影、去雾化、伽马校正、边缘增强和自动白平衡等。

本项目适用于需要远程监控和管理视频流的场景，例如家庭安防、工业监控或视频处理实验。

改进详见：[Plus.md](./Plus.md)

---

## 功能

- **视频流管理**：
  - 打开、暂停、继续和关闭特定的视频流。
  - 同时支持多路视频流（目前仅视频流 1 连接本机摄像头）。
- **参数调整**：
  - 使用滑块实时调整视频流的以下参数：
    - 亮度 (0.5 - 2)
    - 对比度 (0.5 - 2)
    - 饱和度 (0.5 - 2)
    - 锐化 (0 - 10)
    - 色温 (-1 - 1)
    - 降噪 (0 - 10)
    - 模糊 (0 - 10)
    - 晕影 (0 - 1)
    - 去雾化 (0 - 1)
    - 伽马校正 (0.5 - 2)
    - 边缘增强 (0 - 10)
    - 自动白平衡 (开关)
- **实时视频流**：
  - 通过网页界面以 MJPEG 格式实时查看调整后的视频流。

---

## 安装

### 环境要求

- **操作系统**：Windows、Linux 或 macOS
- **Python 版本**：3.6 或更高版本
- **硬件**：支持摄像头（仅视频流 1 需要本机摄像头）

### 安装步骤

1. **安装 Python**：

   - 确保系统中已安装 Python 3.6 或更高版本。可从 [Python 官网](https://www.python.org/) 下载安装。
   - 验证安装：运行 `python --version` 或 `python3 --version`。
2. **安装依赖库**：

   - 在终端中运行以下命令安装必要的 Python 库：
     ```bash
     pip install flask opencv-python numpy
     ```
3. **下载项目文件**：

   - 将本项目文件下载或克隆到本地目录，例如：
     ```bash
     git clone <repository-url>
     ```
   - 或直接下载 ZIP 文件并解压。
4. **运行应用程序**：

   - 进入项目目录，运行以下命令启动 Flask 服务器：
     ```bash
     python app.py
     ```
   - 启动成功后，终端将显示服务器运行在 `http://localhost:5000`。

---

## 使用说明

1. **访问应用程序**：

   - 打开浏览器，输入 `http://localhost:5000` 并访问。
2. **选择视频流**：

   - 主界面显示 4 个视频面板（监控 1 至监控 4）。
   - 点击任意视频面板以选中该视频流，选中面板将以绿色边框高亮。
3. **控制视频流**：

   - **打开**：点击“打开”按钮启动选中的视频流。
   - **暂停**：点击“暂停”按钮暂停视频流。
   - **继续**：点击“继续”按钮恢复暂停的视频流。
   - **关闭**：点击“关闭”按钮停止视频流并释放资源。
4. **调整参数**：

   - 在控制面板中使用滑块调整选中的视频流参数。
   - 参数调整将实时反映在视频流上。
   - 示例：将“亮度”滑块从 1.0 调整至 1.5，视频将变亮。
5. **示例界面**：

   - 主界面分为视频面板区和控制区：
     - **视频面板区**：显示多个视频流窗口。
     - **控制区**：包含操作按钮和参数调整滑块。

---

## 项目结构

```
video-surveillance/
├── app.py                  # Flask 主应用程序文件
├── templates/
│   └── index.html          # 网页界面模板
├── static/                 # 图标库
└── README.md               # 本文档
```

---

## 代码组织

- **app.py**：

  - **视频流管理**：`video_streams` 字典存储每个视频流的状态（是否打开、暂停事件、处理器和摄像头对象）。
  - **视频处理器**：`VideoProcessor` 类负责处理视频帧并应用用户调整的参数。
  - **帧生成**：`gen_frames` 函数生成处理后的视频帧并以 MJPEG 格式传输给前端。
  - **路由**：
    - `/`：渲染主界面。
    - `/video_feed/<stream_id>`：提供视频流。
    - `/start_video/<stream_id>`、`/pause_video/<stream_id>`、`/resume_video/<stream_id>`、`/stop_video/<stream_id>`：处理控制命令。
- **templates/index.html**：

  - 使用 HTML、CSS 和 JavaScript 实现动态界面。
  - JavaScript 函数（如 `startVideo`、`updateVideoParameters`）与后端交互。
- **static/**：

  - 存放图标等静态资源。

---

## 注意事项

- **摄像头支持**：
  - 目前仅视频流 1 使用本机摄像头（`cv2.VideoCapture(0)`）。
  - 其他视频流（2、3、4）未连接摄像头，显示“Camera not connected”。--根据需要连接
- **性能**：
  - 参数调整实时生效，但高分辨率视频或复杂处理可能影响性能，具体取决于硬件配置。
- **摄像头占用**：
  - 确保运行时本机摄像头未被其他程序占用，否则视频流 1 将无法启动。
- **调试模式**：
  - 默认以调试模式运行（`debug=True`），生产环境建议关闭。

---

## 联系方式

如有问题或建议，请通过以下方式联系：

- [邮箱](3143184356@qq,com)

---

通过以上内容，用户可以快速了解项目功能、安装和使用方法，同时开发人员也能通过项目结构和代码组织轻松上手修改代码。欢迎体验和反馈！
